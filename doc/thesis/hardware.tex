\chapter{Überblick über die Hardware}

Die Motorplatine wurde im Zuge der Studienarbeit von Timo Klingeberg \cite{STUD_TIMO}
entwickelt.
\begin{figure}[htb]
 \centering
 \scalebox{0.5}{\includegraphics{pictures/board.png}}
 \caption{\label{board}Die Motorplatine}
\end{figure}
\section{Mikrocontroller}
Das Herzstück der Platine bildet ein Mikrocontroller der Firma Atmel.
Es handelt sich hierbei um einen ATMEGA2561\cite{ATMEGA_MANUAL}, der 256 KiB Speicher für
Programme (Flash) hat, sowie 8 KiB Speicher für Variablen (SRAM). Der maximale Takt für
diesen Mikrocontroller liegt bei 16 MHz, der auch ausgenutzt wird. Das bedeutet, dass
ein Takt 62,5 ns benötigt. Da der Großteil der Instruktionen des Mikrocontrollers nur
einen Takt benötigt, kann dieser theoretisch 16 MIPS leisten. Durch die Benutzung
von Funktionen, Pin-IO und bedingten Sprüngen bleibt dies aber nur eine theoretische Zahl.
Vorteilhafterweise unterstützt der Controller das ISP (In-System Programming). Das war bei der
Entwicklung der Betriebssoftware von großem Nutzen, da hierdurch schnell und relativ
unkompliziert neue Versionen auf die Platine überspielt werden konnten.\\
Der Controller verfügt über 6 Timer. Zwei von diesen haben nur 8 Bit, die anderen vier
16 Bit. Das entspricht bei dem gegebenen Takt von 16 MHz einem maximalen Timer-Intervall von 262 ms.
Zusätzlich kann der Controller sechs Pulsweitenmodulationen betreiben, von
denen zwei für die Servomotoren benutzt werden, die die Räder antreiben.
\section{Ein-/Ausgabemöglichkeiten zur Praktikumsplatine}
Die Motorplatine verfügt sowohl über einen UART-Port, als auch einen I2C-Bus \cite{I2C_WIKI}, über die
die Praktikumsplatine mit der Motorplatine kommunizieren kann. Der UART-Port wird außerdem
für die Ausgabe von Debug-Informationen benutzt, falls diese aktiviert wird. Im Allgemeinen
wird allerdings nur der I2C-Bus zur Kommunikation zwischen den beiden Platinen verwendet.
Da der Mikrocontroller über eingebaute Hardwarelogiken für den I2C-Bus und auch
den UART-Port verfügt, hält sich der administrative Aufwand für die Kommunikation in engen
Grenzen. Es können lediglich Interrupt Service Routinen (ISR) für diese Kommunikations-Einrichtungen zur Verfügung gestellt
werden. Dadurch ist es möglich, schnell auf Situationen zu reagieren, ohne Informationen verlieren zu können.
\section{Interne Ein-/Ausgabe-Ports}
Zusätzlich zu den externen Kommunikationsmöglichkeiten besitzt der ATMEGA2561 54
programmierbare IO Kanäle, die in Ports mit je 8 Kanälen zusammenfasst werden. 16 von diesen
Kanälen sind für die Steuerung der Servomotoren zuständig, die die Räder und die Hall-Sensoren betreiben.
Diese Sensoren, die an den Motoren befestigt sind, lösen bei Bewegung der Räder Unterbrechungen aus.
Damit liefern sie Informationen, aus denen auf die Drehrichtung der Räder und die Strecke, die zurückgelegt wurde,
geschlossen werden kann.
Für jede Umdrehung eines Rades werden 360 Interrupts ausgelöst, d.h. für jedes Grad ein Interrupt. Je
nach Größe des Raddurchmessers ist eine Steckenauflösung von wenigen Millimetern möglich.
